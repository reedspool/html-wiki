<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>Create Page</title>
    <meta name="description" content="Create content here" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  </head>

  <body>
    <h1>Create a New Page</h1>
    <slot name="remove">
      <p><a href="?edit">Edit this page</a></p>
      <p>
        You are looking at the <em>template</em> of the create page. This
        template is what you see when you create a new page (hint: add
        <code>?edit</code> to the end of any page's URL to edit it, this is all
        the "Edit this page" link does). Note that if you remove or break the
        <code>&lt;slot name="content"&gt;</code> element within the
        <code>&lt;textarea&gt;</code> below, you'll break the editing feature of
        the site. Try not to do that.
      </p>
    </slot>
    <form method="GET">
      <!-- Get time once so they don't differ, and remove milliseconds  -->
      <set-
        timestamp="Temporal.Now.plainDateTimeISO().toString().replace(/\.\d+$/,'')"
      ></set->
      <input
        type="hidden"
        name="filename"
        x-value="topLevelParameters.timestamp.replace(/[:.]/g,'-'),_=>_+'.md'"
      />
      <input
        type="hidden"
        name="fileContent"
        x-value="topLevelParameters.timestamp,_=>'# '+_+'\n\n'"
      />
      <button type="submit">Template: Timestamp</button>
    </form>
    <form method="GET">
      <input
        type="hidden"
        name="fileContent"
        x-value="render('/system/templates/empty.html', { raw: true }),p=>escapeHtml(p)"
      />
      <button type="submit">Template: HTML</button>
    </form>
    <form method="GET">
      <input type="hidden" name="fileContent" x-value="'# \n\n'" />
      <button type="submit">Template: Markdown</button>
    </form>
    <form method="POST">
      <drop-if truthy="topLevelParameters.filename">
        <input
          input
          type="text"
          name="contentPath"
          value=""
          placeholder="Leave blank to generate from title"
        />
      </drop-if>
      <keep-if truthy="topLevelParameters.filename">
        <input
          type="text"
          name="contentPath"
          x-value="topLevelParameters.filename"
          placeholder="posts/New Page"
        />
      </keep-if>
      <label>
        File type
        <select name="type">
          <option value="html">HTML</option>
          <option value="md">Markdown</option>
        </select>
      </label>
      <query-content
        q="render('/system/templates/editor.fragment.html', { editContent: topLevelParameters.fileContent || '', saveParameters: 'create' })"
      ></query-content>
    </form>
  </body>
</html>
