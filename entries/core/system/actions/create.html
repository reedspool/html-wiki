<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>Create Page</title>
    <meta name="description" content="Create content here" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  </head>

  <body>
    <h1>Create a New Page</h1>
    <form method="GET">
      <!-- Get time once so they don't differ, and remove milliseconds  -->
      <set-
        timestamp="Temporal.Now.plainDateTimeISO().toString().replace(/\.\d+$/,'')"
      ></set->
      <input
        type="hidden"
        name="filename"
        x-value="timestamp.replace(/[:.]/g,'-'),_=>_+'.md'"
      />
      <input
        type="hidden"
        name="fileContent"
        x-value="timestamp,_=>'# '+_+'\n\n'"
      />
      <button type="submit">Template: Timestamp</button>
    </form>
    <form method="GET">
      <input
        type="hidden"
        name="fileContent"
        x-value="render('/system/templates/empty.html', { raw: true }),p=>escapeHtml(p)"
      />
      <button type="submit">Template: HTML</button>
    </form>
    <form method="GET">
      <input type="hidden" name="fileContent" x-value="'# \n\n'" />
      <button type="submit">Template: Markdown</button>
    </form>
    <form method="POST">
      <drop-if truthy="filename">
        <input
          input
          type="text"
          name="contentPath"
          value=""
          placeholder="Leave blank to generate from title"
        />
      </drop-if>
      <keep-if truthy="filename">
        <input
          type="text"
          name="contentPath"
          x-value="filename"
          placeholder="posts/New Page"
        />
      </keep-if>
      <label>
        File type
        <select name="type">
          <option value="html">HTML</option>
          <option value="md">Markdown</option>
        </select>
      </label>
      <query-content
        q="render('/system/templates/editor.fragment.html', { editContent: fileContent || '', saveParameters: 'create', target: '/' })"
      ></query-content>
    </form>
  </body>
</html>
